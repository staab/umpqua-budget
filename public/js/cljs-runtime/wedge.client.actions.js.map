{"version":3,"file":"wedge.client.actions.js","sources":["wedge/client/actions.cljs"],"mappings":";;;;AAIA,AAAA,AAIA,+CAAA,/CAAMA;AAAN,AACE,mGAAA,nGAACC,mDAAMC,gCAAaC,0EAAc,AAAU,KAAAC;;AAC5C,kCAAA,+EAAA,2CAAA,kEAAA,AAAAC,vNAACC,uOAAuCC;;AAE1C,4CAAA,5CAAMC,gGAAiBC;AAAvB,AACE,kCAAA,wEAAA,2CAAA,9IAACH,oNAAqCG;;AAExC,0CAAA,1CAAMC;AAAN,AACE,OAAOC;;AAIT,AAAAC,2EAAA,2EAAA,WAAAC;AAAA,AAAA,IAAAC,aAAAD;IAAAC,iBAAA,EAAA,EAAA,EAAA,CAAAA,cAAA,QAAA,EAAA,EAAA,CAAA,AAAAA,iDAAA,WAAA,CAAAC,gCAAA,AAAAD,+BAAA,KAAA,OAAA,QAAA,AAAAE,8CAAAC,mBAAAH,YAAAA;cAAA,AAAAI,4CAAAJ,eAAA,rEAAoDK;AAApD,AACE,AAACC,mDAAMC,yBAAMC,gBAAMH;;AACnB,OAACI;;AAEH,AAAAX,2EAAA,kFAAA,WAAAY;AAAA,AAAA,IAAAC,aAAAD;IAAAC,iBAAA,EAAA,EAAA,EAAA,CAAAA,cAAA,QAAA,EAAA,EAAA,CAAA,AAAAA,iDAAA,WAAA,CAAAV,gCAAA,AAAAU,+BAAA,KAAA,OAAA,QAAA,AAAAT,8CAAAC,mBAAAQ,YAAAA;cAAA,AAAAP,4CAAAO,eAAA,rEAAwDN;AAAxD,AACE,OAACC,mDAAMlB,gCAAaoB,gBAAMH;;AAI5B,oCAAA,2CAAA,iEAAA,SAAA,oDAAA,UAAA,oDAAA,iCAAA,2DAAA,mFAAA,uBAAA,2DAAA,8BAAA,1iBAAKO,0mBAMSlB;AAEd,AAAKG,qCAAc,AAASgB,oBAAa,AAACC,qBAAQF","names":["wedge.client.actions/load-transactions!","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$4","wedge.client.state/transactions","cljs.core/assoc","js/Date","cljs.core/deref","wedge.client.ws/send!","wedge.client.state/session-id","wedge.client.actions/create-session!","v","wedge.client.actions/link-account!","wedge.client.actions/plaid-handler","wedge.client.ws/handle-message","p__10782","map__10783","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply.cljs$core$IFn$_invoke$arity$2","cljs.core/hash-map","cljs.core.get.cljs$core$IFn$_invoke$arity$2","payload","cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$3","wedge.client.state/state","cljs.core/merge","wedge.client.state/save-state!","p__10785","map__10786","wedge.client.actions/plaid-config","window/Plaid","cljs.core/clj->js"],"sourcesContent":["(ns wedge.client.actions\n  (:require [wedge.client.state :refer [state transactions session-id save-state!]]\n            [wedge.client.ws :refer [send! handle-message]]))\n\n(declare plaid-handler)\n\n;; App actions\n\n(defn load-transactions! []\n  (swap! transactions assoc :loaded (.valueOf (js/Date.)))\n  (send! :load-transactions {:session-id @session-id}))\n\n(defn create-session! [v]\n  (send! :create-session {:public-token v}))\n\n(defn link-account! []\n  (.open plaid-handler))\n\n;; Websocket handlers\n\n(defmethod handle-message :session-created [{:keys [payload]}]\n  (swap! state merge payload)\n  (save-state!))\n\n(defmethod handle-message :transactions-loaded [{:keys [payload]}]\n  (swap! transactions merge payload))\n\n;; Plaid\n\n(def plaid-config\n  {:clientName \"Budgie\"\n   :env \"sandbox\"\n   :key \"10e3761c1655ff33ff9c5f410122ba\"\n   :product [\"transactions\"]\n   :webhook \"https://wedge.herokuapp.com\"\n   :onSuccess create-session!})\n\n(def plaid-handler (.create window.Plaid (clj->js plaid-config)))\n\n"]}